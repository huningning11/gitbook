# RB09 超声波传感器

## 课程概述

- 课程名称：见标题
- 课程时长：40 分钟 × 2
- 课程内容：超声波传感器的使用
- 学生群体：3~6 年级

```plain
本课内容参考来源：
1. 内容来源一：《树莓派初级课程V1（吴俊杰老师18课时）》第 10 课
2. 内容来源二：课件 1.0 初级 1，第 08 课
```

## 教学目标

### 考察点

1. 认识超声波传感器并说出应用范围
2. 能够自主安装超声波传感器
3. 能够通过检查超声反馈的不同距离控制小灯

### 知识与技能

1. 超声波传感器
2. 条件语句、多分支的条件语句
3. 变量的使用

### 情感价值和学科交叉

感受电子器件在生活中的应用

### 难点和注意事项

（略）

## 教学准备

- 按教学基础要求进行准备
- 实验材料：树莓派基础套件（含小灯及超声传感器）

## 课堂教学活动

### 暖场（10分钟）

活跃气氛，复习上节课内容，引入本节课主题

复习：
- 模拟信号和数字信号
- 光敏传感器

### 课堂讲解： （60分钟）

**教学提纲：**

- 前篇
    - 超声波传感器和超声测距原理
    - 测试超声波传感器
    - 超声波控制刹车灯
- 后篇
    - 不同距离显示不同的小灯
    - 不同距离小灯以不同频率闪烁
- 巩固练习和作业（根据整体或个别学生学习情况酌情选择作为课堂巩固练习或课后作业。课堂练习可分为2~3人小组进行讨论合作）
    1. 不同距离，用流水灯流动速度的改变来表示。
    2. 结合蜂鸣器来提示距离。

**授课内容**：详见下文“讲义”部分。
    
### 总结与点评（10分钟）

*(回顾课程知识点，根据情况提问。如果有学生作品，邀请学生上台演示、讲解。)*

## 讲义 *(完整授课内容和补充知识)*

### 超声波传感器和超声测距原理

超声波

人的耳朵能听到的声波频率为20～20000Hz，当声波的振动频率大于20000Hz时，人耳无法听到。超声波因其频率下限大约等于人的听觉上限而得名。因此，我们把频率高于20000赫兹的声波称为“超声波”。

超声波传感器是将超声波信号转换成电信号的传感器。

<div align="center">
    <img src="/media/15589462753805.jpg">
</div>

超声波的应用非常广泛，常见的有裂隙检测、液面水位检测、距离检测（如倒车雷达）、超声波雾化、超声波清洗……等等。

工作原理是：

超声波发射，遇到物体被反射，传输回来被检测。
根据发送和接收到的时间差，可计算阻碍物的距离。

思考：与红外传感器有什么区别？

### 任务一：测试超声波传感器

基本硬件（以 HC-SR04 型为例。其它型号请根据实际情况调整授课）：

HC-SR04超声波测距模块可提供2cm-400cm的非接触式距离感测功能，测距精度可达高到3mm；
模块包括超声波发射器、接收器与控制电路。有两个探头，一个发射超声波，另一个接收。有效测距范围为2——400CM，2CM以内为盲区。

如果收到反射波,模块的ECHO输出一个宽度为150us的负脉冲,从TRIG=1到ECHO=0的时间即为从发射到收到发射波的时间.


基本工作原理

- 采用IO口TRIG触发测距，给最少10us的高电平信号；
- 模块自动发送8个40khz的方波，并实时检测是否有信号返回；
     发出信号的同时，传感器在ECHO端会输出一个高电平，一旦传感器接收到反射回来的超声波，ECHO就会跳转为低电平。  
- 因此“从TRIG=1到ECHO=0的时间”即为超声波从发射到返回的时间。$$ 测试距离 = \frac { ECHO高电平持续时间  \times  声速即340m/s } {2} $$ *为什么除以2？因为飞行时间对应的是来回的路径。*

看起来计算过程很复杂？这些计算已经被封装在我们编程的调用模块中了：“超声波测距”

连接：

1.  VCC 电源端
2.  TRIG 控制端
3.  ECHO 接收端
4.  GND地线（也即电源的负极）

连接到扩展板对应接口即可（扩展板有专用连接插槽）。然后通过输出超声波调试信息来进行测试：

<div align="center">
    <img src="/media/15589469974369.jpg">
</div>

在超声波传感器正前方移动障碍物，观察输出变化。


### 任务二：超声波控制刹车灯

<div align="center">
    <img src="/media/15590422767325.jpg">
</div>

### 任务三：通过多个灯指示不同距离

<div align="center">
    <img src="/media/15620343689592.jpg">
</div>

演示：由远到近，可以看到灯逐个亮起；  

### 实验四：通过改变闪烁频率来指示距离

用呼吸灯指示系统正常工作。
障碍物进入范围时开始闪烁，并用灯的闪烁频率来指示距离。

我们用同一段代码来控制闪烁，用变量来控制闪烁的频率。

<div align="center">
    <img src="/media/15620374545838.jpg">
</div>

这里注意我们需要一个“否则”来确保所有条件均不满足的时候，变量“闪灯时长”也能正确复制，否则可能会导致变量没有正确初始化导致程序执行错误。当然也可以在条件语句之前先给闪灯时长一个默认值。

## 课件

根据本教学计划和讲义，以及具体授课对象编写。

文件名应为：

`RB09-超声波传感器.pptx`

