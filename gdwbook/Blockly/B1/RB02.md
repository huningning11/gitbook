# RB02 小灯控制和程序结构

## 课程概述

- 课程名称：见标题
- 课程时长：40 分钟 × 2
- 课程内容：结合使用 GPIO、LED、红外传感器制作闪烁的小灯
- 学生群体：3~6 年级

```plain
本课内容参考来源： 
1. 《树莓派初级课程V1（吴俊杰老师18课时）》第 2 课
2. 课件 1.0 初级 1，第 02 课 
3. 酌情增删内容
```

## 教学目标

### 考察点

1. 安装LED灯
2. 进入GDW编程平台
3. 系列点亮小灯任务

### 知识与技能

 - GPIO 和扩展板
 - LED，正负极，安装
 - 古德微编程平台进入和操作
 - 程序基本结构：顺序、循环、选择
 - 顺序结构
 - 循环结构基础，无参数控制和带参数控制的循环
 - 电动势（水位）、电压、电路图、电路图标
 - 周期、频率

### 难点和注意事项

**注意事项：**

本课会讲解二极管直接连接电源。由于树莓派电源有3.3v 和 5v 两种，均超过目前古德微库存二极管最大电压，会导致二极管击穿损坏。目前库存中仅蓝色二极管可承受（截至2019 年 5 月）。如果要演示，请使用蓝色二极管，或后续入库最大电压 3.3v/5v 以上二极管。

### 情感价值和学科交叉

- 开始逐步感知较复杂的逻辑，了解编程的基础是行为逻辑
- 通过设计逻辑和实现，锻炼解决问题能力

## 教学准备

- 按教学准备基础要求进行准备
- 注意检查需要四个以上不同颜色的 LED

## 课堂教学活动

### 暖场（10分钟）

复习上节课内容

提问：

- 计算机是什么，树莓派是什么？
- 如何连接树莓派

实际操作树莓派的连接、开机、进入编程平台

### 课堂讲解：小灯控制和程序结构（50~60分钟）

**教学提纲：**

- 前篇
    - 小灯/LED，正负极
    - GPIO 简单介绍，电源和接地 
    - 任务1 点亮小灯/熄灭小灯
    - 任务2 小灯亮3秒后熄灭
    
- 后篇
    - 循环指令详细介绍
    - 任务3：10秒内，灯闪烁5次
    - 任务4：跳动的小灯（不带参数的循环）
    - 任务5：带参数循环
    - 红外控制亮灯（本节或下节，内容见 RB03） 

- 扩展内容（酌情加入）
    - 使用带参数循环及选择语句
    - 基本电路图
    
- 巩固练习和作业
    - 试试看可不可以换个GPIO也可以通过程序控制小灯
    - 试试看可不可以按自己意愿控制小灯亮起的时间
    - 试试看可不可以控制多个小灯亮起或闪烁

**授课内容**：详见下文“讲义”部分。


### 总结与点评（10分钟）

思考题：

- 怎样点亮发光二极管？
- 什么是 GPIO？
- 带参数循环和不带参数循环有什么不同？
- 什么时候需要需要用带参数循环？

## 讲义

*(完整授课内容和补充知识)*

<div align="center">
    <img src="/media/15572158460201.jpg">
</div>

General Purpose Input Output（通用输入/输出）简称为GPIO
即这个引脚可以输出信号（比如点亮小灯）；
也可以接受信号（比如接受红外传感器反馈）

扩展板引脚标的数字都是GPIO的意思。

发光二极管(LightEmitting Diode,LED)简称为LED，是一种半导体组件。

<div align="center">
    <img src="/media/15572844237643.jpg">
    <img src="/media/15572844468590.jpg">
</div>

拓展板上有5号、6号、12号、16号共四个接口可以接LED灯。实际上其它接口也可以用，怎么做在后面的课程中讲。

增加概念：电动势（水位）、电压、电路图、电路图标

想一想灯是怎样点亮的？GPIO 可以通过信号控制灯的亮灭。但是实际上直接将 LED 接通电源和接地，它直接就会亮。

<div align="center">
    <img src="/media/15572845260454.jpg">
</div>

### 古德微编程平台

单击菜单中Web Browser输入网址：
www.gdwrobot.cn/robot_system/#/login
或选择GDW Robot项目就会出现系统登录界面
输入账号和密码，进入GDWROBOT古德微机器人。
点击设备控制，即进入编程界面。
点击连接设备即做好编程后的测试准备工作。

注意事项：

- 如果是远程连接，务必保证树莓派与操作电脑处于同一网段
- 执行指令前需要“连接设备”
- 点击绿色“运行”按钮，脚本才会被执行

### 任务一：点亮/熄灭小灯

操作步骤：

1. 智能硬件——常用——控制【*号小灯】——亮或灭
2. 点击绿色箭头运行程序即可点亮或熄灭相应小灯

<div align="center">
    <img src="/media/15572167501538.jpg">
</div>

### 任务二：小灯亮三秒后熄灭

操作步骤：

1. 智能硬件——常用——控制【*号小灯】——亮；
2. 时间——等待3秒。“等待（）秒”积木在左侧积木区“时间”模块中；
3. 智能硬件——常用——控制【*号小灯】——灭

<div align="center">
    <img src="/media/15572170270480.jpg">
</div>

程序的顺序结构

- 程序一次性运行完；
- 结果按照结尾处的指令；
- 用于单次控制

### 任务三：10 秒内小灯闪烁 5 次

方案一，顺序拼接亮灭和等待积木

方案二，使用循环。操作步骤：

1. 循环5次——执行；
2. 智能硬件——常用——控制【*号小灯】——亮；
3. 时间——等待1秒；
4. 智能硬件——常用——控制【*号小灯】——灭；
5. 时间——等待1秒；

<div align="center">
    <img src="/media/15572172405493.jpg">
</div>

### 循环

在不少实际问题中有许多具有规律性的重复操作，因此在程序中就需要重复执行某些语句。

- 一组被重复执行的语句称之为**循环体**；
- 能否继续重复，取决于循环的**终止条件**

<div align="center">
    <img src="/media/15572186958561.jpg">
</div>

注意看，我们在实现闪灯时可能会有如下三种不同的实现。哪种是正确的？三种实现效果会有什么不同？

<div align="center">
    <img src="/media/15572183588294.jpg">
</div>

不同之处：在执行三个程序块后，第1个程序块的现象是只看到一亮马上就熄灭了；第2个程序块的现象是灯长亮之后熄灭；第3个程序块的现象是真正看到了重复亮、灭循环5次。

在设计程序时，一定要能真正体现出循环执行的过程。

**注意：**

- 循环必须有终止条件，否则就会进入“**死循环**”
- 一定要避免“空”的循环


### 程序基本结构

<div align="center">
    <img src="/media/15572870933801.jpg">
</div>

顺序结构：从头到尾
循环结构：每次执行完后，回到头部重新执行
分支/选择结构：根据条件不同来选择不同路径

### 小灯

增加 概念：周期、频率

<div align="center">
    <img src="/media/15572875293414.jpg">
</div>

### 任务四：跳动的小灯（无参数循环）

目标：间隔的两个小灯为一组，交替闪烁。

执行逻辑：

- 5和12号灯亮，6和16号灯灭；
- 0.5秒钟后，
- 5和12号灯灭，6和16号灯亮，循环5或10次。

<div align="center">
    <img src="/media/15572190434373.jpg">
</div>

思考：

- 循环体是什么？
- 循环终止的条件是什么？
- 重复执行了几次？
- 每个小灯亮了几次，灭了几次？
- 从开始到结束，程序执行了多长时间？


### 任务五：带参数循环指令

使用带参数循环实现小灯闪烁。实现时思考如下问题：

1. 循环体是什么？
2. 循环终止的条件是什么？
3. 重复执行了几次？
4. 小灯亮了几次，灭了几次？
5. 从开始到结束，程序执行了多长时间？


简单闪烁：

<div align="center">
    <img src="/media/15572196894098.jpg">
</div>

跳动（使用带参数循环改造任务四）。方法同上。

### 拓展任务：使用带参数循环及选择语句

本任务根据教学进度和课堂情况，可在本节或下节进行。

<div align="center">
    <img src="/media/15572944019573.jpg">
</div>

思考：

1. 这种实现和任务四有什么不同？
2. 重复执行了几次？如果要闪烁同样的次数，循环次数和任务四有何不同？

## 课件

根据本教学计划和讲义，以及具体授课对象编写。

文件名应为：

`RB02-小灯控制和程序结构.pptx`

