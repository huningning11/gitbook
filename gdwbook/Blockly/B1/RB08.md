# RB08 红外和光敏传感器

## 课程概述

- 课程名称：见标题
- 课程时长：40 分钟 × 2
- 课程内容：学习传感器的检测和根据传感器数据进行逻辑控制
- 学生群体：3~6 年级

```plain
1. 《树莓派初级课程V1（吴俊杰老师18课时）》第 8、9 课
2. 课件 1.0 初级 1，第 07 课 
3. 其它增删调整
```

## 教学目标

### 考察点

- 能正确连接红外传感器
- 能正确获取红外传感器状态并执行相应控制
- 能正确连接光敏传感器
- 能正确获取光敏传感器数据

### 知识与技能

- 红外传感器
- 光敏传感器
- 模数转换
- 调试输出

### 情感价值和学科交叉

本课开始正式讲授传感器的概念，真正实现虚拟世界对外界环境变化的自动感知。完成“机器人”或者说自动控制系统的闭环。

### 难点和注意事项

注意区分红外检测和光敏检测。看起来用手遮挡这种操作是一样的，但是有本质区别。为加深理解，在条件允许的情况下，可以用暗室来演示。

根据所用的光敏器材的不同，光敏电阻模拟信号输出数据有所不同。我们使用的型号光照越强数字越大（输出电压）。如果使用其它型号导致输出不同，在编写脚本时需要根据器件特性灵活调整。

## 教学准备

- 按教学准备基础要求进行准备
- 其它准备工作：遮光、补光灯等设备

## 课堂教学活动

### 暖场（5分钟）

活跃气氛，复习上节课内容，引入本节课主题

- 复习开关控制
- 复习之前学过的简单红外控制

### 课堂讲解：红外和光敏传感器（60分钟）

**教学提纲：**

- 前篇

    - 信号的收发、传感器的概念和应用
    - 任务一：红外传感器的连接和简单控制（这部分内容在前面的课程中应该已经学习过）
    - 任务二：双手势控制开关灯
    
- 后篇

    - 光敏传感器介绍
    - 任务三：光敏传感器的检测
    - 任务四：智能补光灯


巩固练习：

- 任务五：黑夜自动亮灯，白天自动灭灯


**授课内容**：详见下文“讲义”部分。

    
### 扩展内容 *（根据学生程度酌情加入，不影响主线课程进度）*

扩展知识：

- 模拟信号和数字信号


### 总结与点评（15分钟）

*(回顾课程知识点，根据情况提问。如果有学生作品，邀请学生上台演示、讲解。)*

思考：

1. 环境光亮度反馈的模拟信号是如何和小灯的亮度结合起来的？
2. 如何测量模拟信号反馈的最大值和最小值？

## 讲义 *(完整授课内容和补充知识)*


### 什么是传感器

我们在之前的课程中已经使用过了红外传感器，那么什么是“传感器”呢？

传感器（英文：Sensor）是用于侦测环境，并将接收到的信息发送至其他器件的设备，通常由敏感组件和转换组件组成。传感器能够探测、感受外界的信号、物理条件（如光、热、湿度）或化学组成（如烟雾），按一定规律变换成为电信号或其他所需形式的信息输出。“传感器”在新韦式大词典中定义为：“从一个系统接受功率，通常以另一种形式将功率送到第二个系统中的器件”。根据这个定义，传感器的作用是将一种能量转换成另一种能量形式，所以不少学者也用“换能器－Transducer”来称呼传感器。

传感器的特点包括：微型化、数字化、智能化、多功能化、系统化、网络化。它是实现自动检测和自动控制的首要环节。传感器的存在和发展，让机器有了触觉、味觉和嗅觉等感官，让机器变得活了起来。通常根据其基本感知功能分为热敏元件、光敏元件、气敏元件、力敏元件、磁敏元件、湿敏元件、声敏元件、放射线敏感元件、色敏元件和味敏元件等。


### 任务一：红外传感器的简单使用

<div align="center">
    <img src="/media/15579109650087.jpg">
</div>

红外传感器处理的是一种光学信号：红外线

- 信号
- 信号的发送
- 信号的接收
- 信号的反射

根据结构，红外传感器有分离式和一体式。我们课程中用到的是一体式，即发射管和接收管集成在同一个器件上。

连接方式：

<div align="center">
    <img src="/media/15579113412138.jpg">
</div>

回顾前面使用过的手势开灯。

### 巩固练习

- 反过来，无障碍亮，有障碍灭
- 尝试通过一个红外传感器控制多个灯，但是一次只能亮一个灯（类似流水灯）。
- 有障碍物先开灯，延时关灯

### 任务二：双手势控制

目标：一个红外传感器控制亮灯，另一个控制灭灯

我们增加一个红外传感器。一个红外传感器用于开灯，一个红外传感器用于关灯。第二个红外传感器我们需要用杜邦线连接到对应的接口，我们这里选连GPIO 25。注意连线的对应。

<div align="center">
    <img src="/media/15579729969098.jpg">
</div>

思考： 为什么红外传感器不能像连GPIO 24一样直接插 GPIO25？

（注：本节可跳过直接进入下节光敏传感器。）

### 扩展知识：机器人的反馈原理

输入：检测信号（竖起耳朵/睁大眼睛）
判断：比较（大脑思考）
决策/行动：输出信号（拿、走、说）

### 认识光敏传感器

光敏传感器是对外界光信号或光辐射有响应或转换功能的敏感装置。

它的种类繁多，主要有：光电管、光电倍增管、光敏电阻、光敏三极管、太阳能电池、红外线传感器、紫外线传感器、光纤式光电传感器、色彩传感器、CCD和CMOS图像传感器等。

最简单的光敏传感器是光敏电阻，当光子冲击接合处就会产生电流。

<div align="center">
    <img src="/media/15579731382525.jpg">
</div>

光敏传感器的工作原理：

光敏传感器是利用光敏元件将光信号转换为电信号的传感器，它的敏感波长在可见光波长附近，包括红外线波长和紫外线波长。光传感器不只局限于对光的探测，它还可以作为探测元件组成其他传感器，对许多非电量进行检测，只要将这些非电量转换为光信号的变化即可。

<div align="center">
    <img src="/media/15579732372559.jpg">
</div>

### 任务三：光敏传感器的检测

光敏传感器的连接：

VCC：电源正极
GND：电源负极
DO：数字输出信号
AO：模拟输出信号

正确连接后：

<div align="center">
    <img src="/media/15589396043045.jpg">
</div>

思考：

1. 光敏传感器那根引脚是用来输出数字信号的？
2. 光敏传感器那根引脚是用来输出模拟信号的？

连接好传感器，通过调试信息来观察当传感器被遮挡时输出的变化。

<div align="center">
    <img src="/media/15589405765483.jpg">
</div>

还可以连接模数转换模块后，读取模拟信号

<div align="center">
    <img src="/media/15589412761492.jpg">
</div>

### 任务四：智能补光灯

根据环境光照强度的变化调整小灯亮度。
光敏信号经过模数转换后，最大值为 32767，PWM 最大值为 3000，根据这个规则列出算式：

$$ 补光值 = \frac { {光敏数据 } \times { 3000} }{32767} $$

<div align="center">
    <img src="/media/15589420380472.jpg">
</div>


## 课件

根据本教学计划和讲义，以及具体授课对象编写。

文件名应为：

`RB08-红外和光敏传感器.pptx`

